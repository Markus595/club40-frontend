<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Club 40 Playlist</title>
  <link rel="stylesheet" href="style.css">
  <script>
    async function fetchData() {
      try {
        const playlistRes = await fetch("https://club-40-2-playlist.onrender.com/playlist");
        const nowPlayingRes = await fetch("https://club-40-2-playlist.onrender.com/now-playing");
        const upNextRes = await fetch("https://club-40-2-playlist.onrender.com/up-next");

        const playlist = await playlistRes.json();
        const nowPlaying = await nowPlayingRes.json();
        const upNext = await upNextRes.json();

        document.getElementById("playlist-name").textContent = playlist.name;
        document.getElementById("cover-now").src = nowPlaying.image;
        document.getElementById("now-title").textContent = nowPlaying.name;
        document.getElementById("now-artist").textContent = nowPlaying.artist;

        const nextList = document.getElementById("next-tracks");
        nextList.innerHTML = "";
        upNext.tracks.forEach(track => {
          const div = document.createElement("div");
          div.className = "next-track";
          div.innerHTML = `
            <img src="${track.image || ''}" alt="Cover">
            <div>
              <strong>${track.name}</strong><br>
              ${track.artist}
            </div>
          `;
          nextList.appendChild(div);
        });

      } catch (e) {
        console.error("Fehler beim Laden der Daten:", e);
      }
    }

    setInterval(fetchData, 5000);
    window.onload = fetchData;
  </script>
</head>
<body>
  <header>
    <h1 id="playlist-name">Club 40 Playlist</h1>
    <img id="logo" src="assets/Club_40.jpeg" alt="Club Logo">
  </header>

  <main>
    <section class="now-playing">
      <img id="cover-now" class="cover" src="" alt="Cover">
      <div class="song-info">
        <h3 id="now-title">Titel</h3>
        <p id="now-artist">Interpret</p>
      </div>
      <div class="progress">
        <div id="progress-bar"></div>
      </div>
    </section>

    <section class="up-next">
      <h2>Playlist</h2>
      <div id="next-tracks"></div>
    </section>
  </main>
</body>
</html>
